import{a as p,f,_ as T}from"./Modal-DL73gfd7.js";import{d as t,f as E,m as j,h as k,c as N,o as b,a as r,j as S,i as B,b as U,w as V,k as $,n as z,l as c}from"./index-Doh7Rih5.js";const O={__name:"ModulePage",setup(A){t([]);const n=t([]),m=t([]);t([]),t([]);const o=t(!1),d=E(),l=t(null);j(async()=>{n.value=await p(),console.log(n.value),m.value=await f()});const v=t([{name:"title",placeholder:"Enter module Title",res:"",type:"text"},{name:"courseId",placeholder:"Select Course Title",res:"",type:"select",options:{}},{name:"active",placeholder:"0 = Not Active, 1 = Active",res:"",type:"number"}]),u=t(null);async function h(e="1"){l.value=e;const a=await c.get(`/api/modules/${e}`),x=Object.entries(a.data).map(([i,M])=>["id","cover_img_url"].includes(i)?null:{name:i,placeholder:"No placeholder",type:"text",res:M}).filter(i=>i!=null);u.value=x,o.value=!0,m.value=await f()}async function w(e){await c.delete(`/api/admin/modules/${e}`),n.value=await p()}function y(e,a){l.value?u.value[e].res=a:v.value[e].res=a}function C(){o.value=!0,u.value=null,l.value=null}async function _(e){const a=Object.fromEntries(e);try{if(l.value){const s=await c.put(`/api/admin/modules/${l.value}`,a,{headers:{"Content-Type":"application/json"}});d.success("Module Edited Successfully...")}else{if((await c.post("/api/admin/modules",a,{headers:{"Content-Type":"application/json"}})).status!==201)throw new Error("Unable to create Module");l.value=null}}catch(s){console.log(s),d.error("Unable to create Module...")}finally{o.value=!1,n.value=await p()}}function g(){o.value=!1}return(e,a)=>{const s=k("CategorizedTable");return b(),N("div",null,[r("div",null,[o.value?(b(),S(T,{key:0,fields:u.value||v.value,onUpdate:y,onClose:g,edit:l.value,onSubmit:_},null,8,["fields","edit"])):B("",!0)]),r("div",{class:z([o.value?"blur":""])},[U(s,{onEdit:h,onDelete:w,items:n.value},{default:V(()=>[r("button",{onClick:C,class:"bg-blue-500 ms-auto py-2 text-white block col-start-2 w-[100px] rounded"},a[0]||(a[0]=[r("i",{class:"ri-add-line"},null,-1),$("Add Module")]))]),_:1},8,["items"])],2)])}}};export{O as default};
