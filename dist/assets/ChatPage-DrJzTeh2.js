import{d as n,m as $,c as i,o as r,a as e,x as S,F as _,r as b,t as w,l as k,_ as M,y as B,h as L,j as C,i as V,k as x,n as f,p as j,v as A,b as F,w as N,z,A as E}from"./index-luTevwiG.js";import{m as H}from"./marked.esm-DKjyhwJX.js";const I={key:0},R={key:1,class:"bg-white p-4 rounded-xl shadow-sm"},D={class:"text-sm text-gray-700"},G=["onClick"],P={__name:"SuggestionCard",props:{inline:{type:Boolean,default:!1}},setup(y){const c=n([]),t=n(!1),s=n(""),d=async()=>{t.value=!0,s.value="";try{const a=await k.get("/api/ebooks/topics");if(!a.status==200)throw new Error("Failed to fetch topics");const o=await a.data;c.value=o.cards.splice(0,3)||[]}catch(a){s.value=a.message}finally{t.value=!1}};async function g(a){try{await navigator.clipboard.writeText(a)}catch(o){console.log(o)}}return $(()=>{d(),console.log(c)}),(a,o)=>t.value?(r(),i("div",I,o[0]||(o[0]=[e("img",{src:S,width:"20",alt:""},null,-1)]))):(r(),i("div",R,[o[1]||(o[1]=e("h3",{class:"text-lg font-semibold mb-2"},"Suggested Topics",-1)),(r(!0),i(_,null,b(c.value,m=>(r(),i("div",null,[e("div",D,[e("div",{onClick:h=>g(m),class:"p-2 mt-2 rounded shadow-lg"},w(m),9,G)])]))),256))]))}},q={class:"flex flex-col h-[500px] bg-white dark:bg-gray-900 rounded-xl shadow p-4"},O=["innerHTML"],U={class:"flex gap-2 justify-end"},J=["disabled"],K={__name:"ChatCard",setup(y){async function c(){const u=await navigator.clipboard.readText();t.value=u,console.log(u)}const t=n(""),s=n([]),d=n(!1),g=n(!0),a=n(null),o="https://apigateway.merilearn.com.ng",m=localStorage.getItem("token")||"",h=async()=>{if(!t.value.trim())return;g.value=!1;const u={role:"user",content:t.value.trim()};s.value.push(u),t.value="",d.value=!0;try{const l=await k.post(`${o}/api/chat`,{message:u.content,history:s.value.slice(-10)},{headers:{Authorization:`Bearer ${m}`}});s.value.push({role:"model",content:l.data.reply});const v=E(()=>{s.map(value({role:value.role,content:H.parse(value.content)}))});console.log(v)}catch(l){s.value.push({role:"model",content:"⚠️ Failed to get response from Gemini."}),console.error(l)}finally{d.value=!1}};return B(s,()=>{nextTick(()=>{a.value.scrollTop=a.value.scrollHeight})}),(u,l)=>{const v=L("RouterLink");return r(),i("div",q,[l[2]||(l[2]=e("div",{class:"text-xl font-semibold mb-2 text-gray-800 dark:text-gray-100"},[x("Chat with AI "),e("div",{class:"text-sm"},"Powered by Gemini")],-1)),g.value?(r(),C(P,{key:0,onClick:c})):V("",!0),e("div",{ref_key:"chatContainer",ref:a,class:"flex-1 overflow-y-auto space-y-4 mb-4 px-2 scroll-smooth"},[(r(!0),i(_,null,b(s.value,(p,T)=>(r(),i("div",{key:T,class:f(["flex",p.role==="user"?"justify-end":"justify-start"])},[e("div",{innerHTML:p.content,class:f(["max-w-sm px-3 py-2 rounded-lg prose-sm",p.role==="user"?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-800 dark:text-gray-100"])},null,10,O)],2))),128))],512),e("form",{onSubmit:z(h,["prevent"])},[j(e("textarea",{"onUpdate:modelValue":l[0]||(l[0]=p=>t.value=p),type:"text",placeholder:"Ask me anything...",class:"w-full px-4 py-2 rounded-lg border dark:border-gray-700 bg-white dark:bg-gray-800 dark:text-white focus:outline-none",required:""},null,512),[[A,t.value]]),e("div",U,[F(v,{to:{name:"ebooks"},type:"submit",class:"px-6 py-2 text-blue-500 rounded-lg hover:bg-blue-700 disabled:opacity-50"},{default:N(()=>l[1]||(l[1]=[x(" Explore Resources ")])),_:1,__:[1]}),e("button",{type:"submit",disabled:d.value,class:"px-6 py-2 bg-black text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},w(d.value?"Sending...":"Send"),9,J)])],32)])}}},Q=M(K,[["__scopeId","data-v-85fe4fce"]]),Y={__name:"ChatPage",setup(y){return(c,t)=>(r(),C(Q))}};export{Y as default};
