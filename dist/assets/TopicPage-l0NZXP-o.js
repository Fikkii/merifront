import{b as m,a as f,_ as S}from"./Modal-DuZiWMRO.js";import{C as B}from"./ChatCard-CZZWKMis.js";import{_ as N}from"./ToastEditor-ChlNwLaN.js";import{d as a,f as V,m as $,h as D,c as z,o as b,a as l,j as M,i as R,w,b as v,n as F,k as O,l as r,M as U}from"./index-CJwAv-gi.js";import"./marked.esm-DKjyhwJX.js";import"./_commonjsHelpers-D6-XlEtG.js";const A={class:"relative flex gap-2"},P={class:"overflow-x-auto max-h-screen"},q={class:"col-span-2"},G=["edit"],H={class:"hidden md:block bg-white rounded-lg p-4 flex-1"},ee={__name:"TopicPage",setup(J){const i=a([]),p=a([]);a([]);const _=a(""),o=a(!1),h=V(),c=a(null),s=a(null),u=a(null),C=a([{name:"title",placeholder:"Enter topic Title",res:""},{name:"courseId",placeholder:"Enter Course ID",res:"",type:"select",options:[]},{name:"moduleId",placeholder:"Enter module ID",res:"",type:"select",options:[]},{name:"recommended_video",placeholder:"Enter Recommended Video link",res:""}]);$(async()=>{i.value=await m(),p.value=await f()});async function g(e){await r.delete(`/api/admin/topics/${e}`),i.value=await m(),p.value=await f(),console.log("Updating...")}async function y(e){c.value&&(_.value=c.value.saveContent()),e.append("content",_.value);const t=Object.fromEntries(e);try{if(s.value){const n=await r.put(`/api/admin/topics/${s.value}`,t,{headers:{"Content-Type":"application/json"}});h.success("Topic Edited Successfully...")}else{const n=await r.post("/api/admin/topics",t,{headers:{"Content-Type":"application/json"}});h.success("Topic Created Successfully...")}o.value=!o.value}catch(n){console.log(n)}finally{i.value=await m(),p.value=await f()}}function T(){o.value=!1}function x(e,t){s.value?u.value[e].res=t:C.value[e].res=t}async function k(e="1"){s.value=e;const t=await r.get(`/api/topics/${e}`),j=Object.entries(t.data).map(([d,I])=>["id","topic_content","module_title","course_title"].includes(d)?null:{name:d,placeholder:"No placeholder",type:"text",res:I}).filter(d=>d!=null);u.value=j,o.value=!0,await U(),c.value.setContent(t.data.topic_content)}function E(){o.value=!0,u.value=null,s.value=null}return(e,t)=>{const n=D("CategorizedTable");return b(),z("div",A,[l("div",P,[l("div",null,[o.value?(b(),M(S,{key:0,fields:u.value||C.value,onUpdate:x,onClose:T,onSubmit:y},{default:w(()=>[l("div",q,[v(N,{ref_key:"toastRef",ref:c},null,512)])]),_:1},8,["fields"])):R("",!0)]),l("div",{class:F([o.value?"blur":""])},[v(n,{groupBy:"module_title",onEdit:k,onDelete:g,items:i.value},{default:w(()=>[l("button",{edit:s.value,onClick:E,class:"bg-blue-500 ms-auto py-2 text-white block col-start-2 w-[100px] rounded"},t[0]||(t[0]=[l("i",{class:"ri-add-line"},null,-1),O("Add Topic")]),8,G)]),_:1},8,["items"])],2)]),l("div",H,[v(B)])])}}};export{ee as default};
