import{_ as I,r as u,h as j,G as B,c as d,o as c,a as t,i as L,y as $,f as G,g as P,t as b,p as R,e as h,b as k,m as y,v as x,H as E,w as V,d as _}from"./index-CJptmEd0.js";import{_ as N}from"./logo-BMUeAq7L.js";import{_ as M}from"./loader-BZfJ8uUy.js";import{_ as O}from"./login-B4lAH5on.js";const U={class:"border-b-1 pb-4"},q="1078148364649-8v697i1oo9e37j36flapdsqca8893ne4.apps.googleusercontent.com",D={__name:"GoogleSigninButton",emits:["success"],setup(S,{emit:r}){const p=r,l=u(null),g=async n=>{const o=n.credential;try{const f=(await L.post("https://servmeri.fikki.com.ng/api/auth/google",{idToken:o})).data;p("success",f)}catch(m){console.error("Auth failed:",m)}};function a(){return new Promise((n,o)=>{let v=0;const w=setInterval(()=>{window.google&&window.google.accounts&&window.google.accounts.id?(clearInterval(w),n()):(v+=50,v>=5e3&&(clearInterval(w),o(new Error("Google Identity Services failed to load in time."))))},50)})}return j(async()=>{window.handleCredentialResponse=g;try{await a(),l.value&&(window.google.accounts.id.initialize({client_id:q,callback:g}),window.google.accounts.id.renderButton(l.value,{theme:"filled_blue",size:"large",type:"standard",shape:"pill",text:"signin_with",logo_alignment:"left"}))}catch(n){console.error(n.message),alert("Failed to load Google login script. Please try again later.")}}),B(()=>{window.handleCredentialResponse&&delete window.handleCredentialResponse}),(n,o)=>(c(),d("div",U,[o[0]||(o[0]=t("h2",null,"Sign in with Google",-1)),t("div",{ref_key:"googleButton",ref:l},null,512)]))}},A=I(D,[["__scopeId","data-v-ff1c6ec5"]]),F={class:"flex h-screen bg-white"},z={class:"w-full md:w-1/2 flex items-center justify-center p-8"},J={class:"w-full max-w-md space-y-3"},W={class:"text-2xl"},H={class:"relative"},K=["type"],Q={key:0},X={key:1},Y={key:0},Z={class:"relative"},ee={key:0},te={key:1},oe={type:"submit",class:"w-full flex gap-4 justify-center py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"},se={key:0,width:"20",src:M,alt:"spinner"},re={__name:"LoginPage",setup(S){const r=$(),p=u(""),l=u(""),g=u(""),a=u(!1);u(!1);const n=u(!1),o=u(!1),m=G();function f(s){s.token?(localStorage.setItem("jwt-token",s.token),localStorage.setItem("user-role",s.user.role),r.success("Login Successfull."),m.push({name:"dashboard-home"})):r.error("Unable to login")}async function v(){try{if(l.value!=g.value)throw new Error("password does not match...");const s=await fetch("https://servmeri.fikki.com.ng/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p.value,password:l.value})}),e=await s.json();if(s.ok)localStorage.setItem("jwt-token",e.token),r.success("Account has been created successfully"),o.value=!1,n.value=!1;else throw new Error(e.error)}catch(s){n.value=!1,r.error(s.message)}}function w(s){o.value?v():C()}async function C(){try{const s=await fetch("https://servmeri.fikki.com.ng/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p.value,password:l.value})}),e=await s.json();if(s.ok)localStorage.setItem("jwt-token",e.token),localStorage.setItem("user-role",e.user.role),r.success("Login Successfull."),m.push({name:"dashboard-home"});else throw new Error(e.error)}catch(s){n.value=!1,r.error(s.message)}}return(s,e)=>{const T=P("RouterLink");return c(),d("div",F,[t("div",z,[t("div",J,[e[13]||(e[13]=t("img",{src:N,width:"65",alt:"logo"},null,-1)),t("div",null,[t("div",W,b(o.value?"Signup":"Login")+" To Continue",1)]),t("form",{onSubmit:e[6]||(e[6]=R(i=>w(),["prevent"])),class:"space-y-4 bg-blue-50 border-blue-500 p-6 rounded-lg shadow-2xl relative"},[h(A,{onSuccess:f}),t("div",null,[e[7]||(e[7]=t("label",{class:"block mb-1 text-gray-700"},"Enter your email address",-1)),y(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>p.value=i),type:"email",required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[x,p.value]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block mb-1 text-gray-700"},"Enter your password",-1)),t("div",H,[y(t("input",{type:a.value?"text":"password","onUpdate:modelValue":e[1]||(e[1]=i=>l.value=i),required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,K),[[E,l.value]]),t("button",{type:"button",onClick:e[2]||(e[2]=i=>a.value=!a.value),class:"absolute inset-y-0 right-3 flex items-center text-gray-600"},[a.value?(c(),d("span",Q,e[8]||(e[8]=[t("i",{class:"ri-eye-close-line"},null,-1)]))):(c(),d("span",X,e[9]||(e[9]=[t("i",{class:"ri-eye-line"},null,-1)])))])])]),o.value?(c(),d("div",Y,[e[11]||(e[11]=t("label",{class:"block mb-1 text-gray-700"},"Confirm your password",-1)),t("div",Z,[y(t("input",{type:"password","onUpdate:modelValue":e[3]||(e[3]=i=>g.value=i),required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[x,g.value]]),t("button",{type:"button",onClick:e[4]||(e[4]=i=>a.value=!a.value),class:"absolute inset-y-0 right-3 flex items-center text-gray-600"},[a.value?(c(),d("span",ee)):(c(),d("span",te))])])])):k("",!0),h(T,{to:{name:"reset-password-email"},href:"#",class:"text-blue-600 float-right hover:underline"},{default:V(()=>e[12]||(e[12]=[_("Forgot password?")])),_:1,__:[12]}),t("button",oe,[t("span",null,b(o.value?"Signup":"Login"),1),n.value?(c(),d("img",se)):k("",!0)]),t("button",{id:"toggler",onClick:e[5]||(e[5]=i=>o.value=!o.value),class:"block m-auto text-center text-blue-800 rounded"},b(o.value?"Already have an account?":"Don't have an account?"),1)],32),e[14]||(e[14]=t("p",{class:"text-center text-xs text-gray-400 mt-20"},[_("Powered by "),t("span",{class:"text-blue-500 font-bold"},"fikki.com.ng")],-1))])]),e[15]||(e[15]=t("div",{class:"hidden md:block md:w-1/2"},[t("img",{src:O,alt:"Man working on laptop",class:"w-full h-full object-cover"})],-1))])}}};export{re as default};
