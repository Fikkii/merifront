import{_ as E}from"./Modal-DuZiWMRO.js";import{_ as P}from"./ToastEditor-ChlNwLaN.js";import{f as S,d as a,m as N,l as n,h as $,c as B,o as h,a as c,j as I,i as M,w as _,b as j,k as V,n as z,M as D}from"./index-CJwAv-gi.js";import"./_commonjsHelpers-D6-XlEtG.js";const F={class:"col-span-2"},O=["edit"],J={__name:"ProjectPage",setup(R){const p=S(),f=a([]),o=a(!1);a([]);const l=a(null),r=a(null),m=a(""),i=a(null),v=a([{name:"title",placeholder:"Enter project Title",res:""},{name:"instructions",placeholder:"Enter project instructions",type:"textarea",res:""},{name:"rubric",placeholder:"Grading Criteria",type:"textarea",res:""},{name:"courseId",placeholder:"Select Module Title",res:"",type:"select",options:{}},{name:"moduleId",placeholder:"Select Module Title",res:"",type:"select",options:{}}]);N(()=>{d()});async function d(){try{const e=await n.get("/api/projects");if(e.status==200){const t=e.data;f.value=t,console.log(e.data)}}catch(e){console.error("Caught error:",e)}}async function y(e){await n.delete(`/api/admin/projects/${e}`),d()}function C(e,t){l.value?i.value[e].res=t:v.value[e].res=t}async function b(e){r.value&&(m.value=r.value.saveContent()),e.append("content",m.value);const t=Object.fromEntries(e);try{if(l.value){const s=n.put(`/api/admin/projects/${l.value}`,t,{headers:{"Content-Type":"application/json"}});p.success("Project has been edited successfully")}else{const s=n.post("/api/admin/projects",t,{headers:{"Content-Type":"application/json"}})}o.value=!1}catch(s){p.error(s)}finally{d(),availableCourse.value=await fetchCourses()}}function g(){o.value=!1}async function x(e="1"){l.value=e;const t=await n.get(`/api/projects/${e}`),w=Object.entries(t.data).map(([u,k])=>["id","evaluation","project_hint"].includes(u)?null:{name:u,placeholder:"No placeholder",type:"text",res:k}).filter(u=>u!=null);i.value=w,o.value=!0,await D(),r.value.setContent(t.data.project_hint)}function T(){o.value=!0,i.value=null,l.value=null}return(e,t)=>{const s=$("CategorizedTable");return h(),B("div",null,[c("div",null,[o.value?(h(),I(E,{key:0,fields:i.value||v.value,onUpdate:C,onClose:g,onSubmit:b},{default:_(()=>[c("div",F,[j(P,{ref_key:"toastRef",ref:r},null,512)])]),_:1},8,["fields"])):M("",!0)]),c("div",{class:z([o.value?"blur":""])},[j(s,{onEdit:x,onDelete:y,items:f.value},{default:_(()=>[c("button",{edit:l.value,onClick:T,class:"bg-blue-500 ms-auto py-2 text-white block col-start-2 w-[100px] rounded"},t[0]||(t[0]=[c("i",{class:"ri-add-line"},null,-1),V("Add Project")]),8,O)]),_:1},8,["items"])],2)])}}};export{J as default};
