import{r as o,y as k,h as x,i as n,g as M,c as p,o as c,a as s,l as S,b as B,w as D,m as V,F as z,j as E,t as F,E as N,e as g,n as $}from"./index-CJptmEd0.js";import{M as I}from"./Modal-CqpnF6AG.js";import{_ as R}from"./ToastEditor-Cokrw1CN.js";import"./_commonjsHelpers-D6-XlEtG.js";const U={class:"relative"},j={class:"mt-3"},A=["value"],L={class:"col-span-2"},K={__name:"TopicPage",setup(P){const v=o([]),m=o([]),r=o([]),f=o(""),a=o(!1),_=k(),i=o(null);x(()=>{d(),b()});function h(e){n.delete(`/api/admin/topics/${e}`),d()}const u=o([{name:"title",placeholder:"Enter topic Title",res:""}]);async function d(){try{const e=await n.get("/api/topics");if(e.status==200){const t=e.data;console.log(t),v.value=t}}catch(e){console.error("Caught error:",e)}}async function b(){try{const e=await n.get("/api/modules");if(e.status==200){const t=e.data;m.value=t}}catch(e){console.error("Caught error:",e)}}function C(e,t){u.value[e].res=t}async function y(){try{i.value&&(f.value=i.value.saveContent());const e=await n.post("/api/admin/topics",{moduleId:r.value,title:u.value[0].res,content:f.value});d(),a.value=!a.value,_.success("Topic Created Successfully...")}catch(e){console.log(e),_.error(e.response.data.error)}}function w(){a.value=!1}return(e,t)=>{const T=M("CategorizedTable");return c(),p("div",U,[s("div",null,[a.value?(c(),S(I,{key:0,fields:u.value,onUpdate:C,onClose:w,onSubmit:y},{default:D(()=>[s("div",j,[V(s("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>r.value=l),class:"p-2 border"},[(c(!0),p(z,null,E(m.value,l=>(c(),p("option",{value:l.id},F(l.module_title),9,A))),256))],512),[[N,r.value]])]),s("div",L,[g(R,{ref_key:"toastRef",ref:i},null,512)])]),_:1},8,["fields"])):B("",!0)]),s("div",{class:$([a.value?"blur":""])},[s("button",{onClick:t[1]||(t[1]=l=>a.value=!a.value),class:"bg-blue-500 py-2 text-white block col-start-2 ms-auto w-[200px] rounded"},"Add topic"),g(T,{onDelete:h,items:v.value},null,8,["items"])],2)])}}};export{K as default};
