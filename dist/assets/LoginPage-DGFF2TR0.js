import{_ as j,d as u,m as R,x as B,c as d,o as c,a as t,l as L,f as P,e as V,h as $,t as b,z as E,b as x,i as k,p as h,v as _,V as G,w as N,k as S,A as U,g as T}from"./index-CJwAv-gi.js";import{_ as M}from"./login-B4lAH5on.js";const O={class:"border-b-1 pb-4"},q="1078148364649-8v697i1oo9e37j36flapdsqca8893ne4.apps.googleusercontent.com",A={__name:"GoogleSigninButton",emits:["success"],setup(C,{emit:i}){const p=i,l=u(null),g=async n=>{const s=n.credential;try{const f=(await L.post("https://apigateway.merilearn.com.ng/api/auth/google",{idToken:s})).data;p("success",f)}catch(m){console.error("Auth failed:",m)}};function a(){return new Promise((n,s)=>{let v=0;const w=setInterval(()=>{window.google&&window.google.accounts&&window.google.accounts.id?(clearInterval(w),n()):(v+=50,v>=5e3&&(clearInterval(w),s(new Error("Google Identity Services failed to load in time."))))},50)})}return R(async()=>{window.handleCredentialResponse=g;try{await a(),l.value&&(window.google.accounts.id.initialize({client_id:q,callback:g}),window.google.accounts.id.renderButton(l.value,{theme:"filled_blue",size:"large",type:"standard",shape:"pill",text:"signin_with",logo_alignment:"left"}))}catch(n){console.error(n.message),alert("Failed to load Google login script. Please try again later.")}}),B(()=>{window.handleCredentialResponse&&delete window.handleCredentialResponse}),(n,s)=>(c(),d("div",O,[s[0]||(s[0]=t("h2",null,"Sign in with Google",-1)),t("div",{ref_key:"googleButton",ref:l},null,512)]))}},D=j(A,[["__scopeId","data-v-ff1c6ec5"]]),z={class:"flex h-screen bg-white"},F={class:"w-full md:w-1/2 flex items-center justify-center p-8"},J={class:"w-full max-w-md mt-20 space-y-3"},W={class:"text-2xl"},H={class:"relative"},K=["type"],Q={key:0},X={key:1},Y={key:0},Z={class:"relative"},ee={key:0},te={key:1},oe=["hidden"],se={key:0,width:"20",src:U,alt:"spinner"},ae={__name:"LoginPage",setup(C){const i=P(),p=u(""),l=u(""),g=u(""),a=u(!1);u(!1);const n=u(!1),s=u(!1),m=V();function f(o){if(n.value=!0,o.token){const e=T();e.setToken(o.token),e.setRole(o.user.role),localStorage.setItem("jwt-token",o.token),localStorage.setItem("user-role",o.user.role),i.success("Login Successfull."),m.push({name:"role"})}else i.error("Unable to login")}async function v(){try{if(l.value!=g.value)throw new Error("password does not match...");const o=await fetch("https://apigateway.merilearn.com.ng/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p.value,password:l.value})}),e=await o.json();if(o.ok)localStorage.setItem("jwt-token",e.token),i.success("Account has been created successfully"),s.value=!1,n.value=!1;else throw new Error(e.error)}catch(o){n.value=!1,i.error(o.message)}}function w(o){s.value?v():I()}async function I(){try{const o=await fetch("https://apigateway.merilearn.com.ng/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p.value,password:l.value})}),e=await o.json();if(o.ok){const y=T();y.setToken(e.token),y.setRole(e.user.role),localStorage.setItem("jwt-token",e.token),localStorage.setItem("user-role",e.user.role),i.success("Login Successfull."),m.push({name:"role"})}else throw new Error(e.error)}catch(o){n.value=!1,i.error(o.message)}}return(o,e)=>{const y=$("RouterLink");return c(),d("div",z,[t("div",F,[t("div",J,[t("div",null,[t("div",W,b(s.value?"Signup":"Login")+" To Continue",1)]),t("form",{onSubmit:e[6]||(e[6]=E(r=>w(),["prevent"])),class:"space-y-4 bg-blue-50 border-blue-500 p-6 rounded-lg shadow-2xl relative"},[x(D,{onSuccess:f}),t("div",null,[e[7]||(e[7]=t("label",{class:"block mb-1 text-gray-700"},"Enter your email address",-1)),h(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>p.value=r),type:"email",required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,p.value]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block mb-1 text-gray-700"},"Enter your password",-1)),t("div",H,[h(t("input",{type:a.value?"text":"password","onUpdate:modelValue":e[1]||(e[1]=r=>l.value=r),required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,K),[[G,l.value]]),t("button",{type:"button",onClick:e[2]||(e[2]=r=>a.value=!a.value),class:"absolute inset-y-0 right-3 flex items-center text-gray-600"},[a.value?(c(),d("span",Q,e[8]||(e[8]=[t("i",{class:"ri-eye-close-line"},null,-1)]))):(c(),d("span",X,e[9]||(e[9]=[t("i",{class:"ri-eye-line"},null,-1)])))])])]),s.value?(c(),d("div",Y,[e[11]||(e[11]=t("label",{class:"block mb-1 text-gray-700"},"Confirm your password",-1)),t("div",Z,[h(t("input",{type:"password","onUpdate:modelValue":e[3]||(e[3]=r=>g.value=r),required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,g.value]]),t("button",{type:"button",onClick:e[4]||(e[4]=r=>a.value=!a.value),class:"absolute inset-y-0 right-3 flex items-center text-gray-600"},[a.value?(c(),d("span",ee)):(c(),d("span",te))])])])):k("",!0),x(y,{to:{name:"reset-password-email"},href:"#",class:"text-blue-600 float-right hover:underline"},{default:N(()=>e[12]||(e[12]=[S("Forgot password?")])),_:1,__:[12]}),t("button",{type:"submit",hidden:n.value,class:"w-full flex gap-4 justify-center py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"},[t("span",null,b(s.value?"Signup":"Login"),1),n.value?(c(),d("img",se)):k("",!0)],8,oe),t("button",{id:"toggler",onClick:e[5]||(e[5]=r=>s.value=!s.value),class:"block m-auto text-center text-blue-800 rounded"},b(s.value?"Already have an account?":"Don't have an account?"),1)],32),e[13]||(e[13]=t("p",{class:"text-center text-xs text-gray-400 mt-20"},[S("Powered by "),t("span",{class:"text-blue-500 font-bold"},"fikki.com.ng")],-1))])]),e[14]||(e[14]=t("div",{class:"hidden md:block md:w-1/2"},[t("img",{src:M,alt:"Man working on laptop",class:"w-full h-full object-cover"})],-1))])}}};export{ae as default};
