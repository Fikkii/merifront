import{r as n,h as S,c as i,o as l,a as e,F as _,j as b,t as m,i as k,_ as $,k as B,g as M,l as w,b as V,d as x,n as f,m as j,v as F,e as N,w as A,p as E}from"./index-CJptmEd0.js";import{_ as I}from"./loader-BZfJ8uUy.js";const L={key:0},R={key:1,class:"bg-white p-4 rounded-xl shadow-sm"},z={class:"text-sm text-gray-700"},D=["onClick"],G={__name:"SuggestionCard",props:{inline:{type:Boolean,default:!1}},setup(h){const c=n([]),t=n(!1),r=n(""),d=async()=>{t.value=!0,r.value="";try{const a=await k.get("/api/ebooks/topics");if(!a.status==200)throw new Error("Failed to fetch topics");const s=await a.data;c.value=s.cards.splice(0,3)||[]}catch(a){r.value=a.message}finally{t.value=!1}};async function g(a){try{await navigator.clipboard.writeText(a)}catch(s){console.log(s)}}return S(()=>{d(),console.log(c)}),(a,s)=>t.value?(l(),i("div",L,s[0]||(s[0]=[e("img",{src:I,width:"20",alt:""},null,-1)]))):(l(),i("div",R,[s[1]||(s[1]=e("h3",{class:"text-lg font-semibold mb-2"},"Suggested Topics",-1)),(l(!0),i(_,null,b(c.value,v=>(l(),i("div",null,[e("div",z,[e("div",{onClick:y=>g(v),class:"p-2 mt-2 rounded shadow-lg"},m(v),9,D)])]))),256))]))}},P={class:"flex flex-col h-[500px] bg-white dark:bg-gray-900 rounded-xl shadow p-4"},q={class:"flex gap-2 justify-end"},H=["disabled"],U={__name:"ChatCard",setup(h){async function c(){const u=await navigator.clipboard.readText();t.value=u,console.log(u)}const t=n(""),r=n([]),d=n(!1),g=n(!0),a=n(null),s="https://servmeri.fikki.com.ng",v=localStorage.getItem("token")||"",y=async()=>{if(!t.value.trim())return;g.value=!1;const u={role:"user",content:t.value.trim()};r.value.push(u),t.value="",d.value=!0;try{const o=await k.post(`${s}/api/chat`,{message:u.content,history:r.value.slice(-10)},{headers:{Authorization:`Bearer ${v}`}});r.value.push({role:"model",content:o.data.reply})}catch(o){r.value.push({role:"model",content:"⚠️ Failed to get response from Gemini."}),console.error(o)}finally{d.value=!1}};return B(r,()=>{nextTick(()=>{a.value.scrollTop=a.value.scrollHeight})}),(u,o)=>{const C=M("RouterLink");return l(),i("div",P,[o[2]||(o[2]=e("div",{class:"text-xl font-semibold mb-2 text-gray-800 dark:text-gray-100"},[x("Chat with AI "),e("div",{class:"text-sm"},"Powered by Gemini")],-1)),g.value?(l(),w(G,{key:0,onClick:c})):V("",!0),e("div",{ref_key:"chatContainer",ref:a,class:"flex-1 overflow-y-auto space-y-4 mb-4 px-2 scroll-smooth"},[(l(!0),i(_,null,b(r.value,(p,T)=>(l(),i("div",{key:T,class:f(["flex",p.role==="user"?"justify-end":"justify-start"])},[e("div",{class:f(["max-w-sm px-4 py-2 rounded-lg",p.role==="user"?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-800 dark:text-gray-100"])},m(p.content),3)],2))),128))],512),e("form",{onSubmit:E(y,["prevent"])},[j(e("textarea",{"onUpdate:modelValue":o[0]||(o[0]=p=>t.value=p),type:"text",placeholder:"Ask me anything...",class:"w-full px-4 py-2 rounded-lg border dark:border-gray-700 bg-white dark:bg-gray-800 dark:text-white focus:outline-none",required:""},null,512),[[F,t.value]]),e("div",q,[N(C,{to:{name:"ebooks"},type:"submit",class:"px-6 py-2 text-blue-500 rounded-lg hover:bg-blue-700 disabled:opacity-50"},{default:A(()=>o[1]||(o[1]=[x(" Explore Resources ")])),_:1,__:[1]}),e("button",{type:"submit",disabled:d.value,class:"px-6 py-2 bg-black text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},m(d.value?"Sending...":"Send"),9,H)])],32)])}}},J=$(U,[["__scopeId","data-v-a44c06c4"]]),Q={__name:"ChatPage",setup(h){return(c,t)=>(l(),w(J))}};export{Q as default};
