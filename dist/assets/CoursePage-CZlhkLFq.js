import{M as w}from"./Modal-CqpnF6AG.js";import{f as x}from"./style-DQTL7hVJ.js";import{r as u,c as p,o as i,a as c,b as v,e as b,u as y,h as k,i as g,g as D,l as B,w as R,n as z}from"./index-CJptmEd0.js";const F={class:"max-w-lg w-full mx-auto px-4 py-6"},I={key:0,class:"relative w-full"},M={__name:"ImageCropper",setup(h,{expose:m}){const l=u(null),s=u(null),d=a=>{const t=a.target.files[0];if(t&&t.type.startsWith("image/")){const r=new FileReader;r.onload=n=>{l.value=n.target.result},r.readAsDataURL(t)}};return m({getCroppedImage:async()=>{var t;const a=(t=s.value)==null?void 0:t.getResult();if(a!=null&&a.canvas){const r=await new Promise(f=>a.canvas.toBlob(f,"image/jpeg",.9)),n=new FormData;return n.append("image",r,"cropped.jpg"),n}}}),(a,t)=>(i(),p("div",F,[c("input",{type:"file",accept:"image/*",onChange:d,class:"mb-4 block w-full border rounded p-2 text-sm"},null,32),l.value?(i(),p("div",I,[b(y(x),{ref_key:"cropper",ref:s,src:l.value,class:"w-full h-[400px] sm:h-[500px] rounded shadow-md overflow-hidden","stencil-props":{aspectRatio:16/9,movable:!0,scalable:!1,resizable:!0},"auto-zoom":!0,"resize-image":{adjustStencil:!0},transitions:!0,"background-class":"bg-white"},null,8,["src"])])):v("",!0)]))}},S={key:0,class:"mb-4"},N={__name:"CoursePage",props:{dashboard:{type:Boolean,default:!1}},setup(h){const m=h,l=u([]),s=u(!1),d=u(null);k(t);function C(e){g.delete(`/api/admin/courses/${e}`),t()}const a=u([{name:"title",placeholder:"Enter Course Title",res:""},{name:"description",placeholder:"Enter Course Description",res:""}]);async function t(){try{const e=await g.get("/api/courses");if(e.status==200){const o=e.data;l.value=o,console.log(e.data)}}catch(e){console.error("Caught error:",e)}}async function r(){const e=await d.value.getCroppedImage();e.append("title",a.value[0].res),e.append("description",a.value[1].res),g.post("/api/admin/courses",e,{headers:{"Content-Type":"multipart/form-data"}}),t(),s.value=!s.value}function n(e,o){a.value[e].res=o}function f(){s.value=!1}return(e,o)=>{const _=D("Table");return i(),p("div",null,[c("div",null,[s.value?(i(),B(w,{key:0,fields:a.value,onUpdate:n,onClose:f,onSubmit:r},{default:R(()=>[b(M,{ref_key:"imageRef",ref:d},null,512)]),_:1},8,["fields"])):v("",!0)]),c("div",{class:z([s.value?"blur":""])},[o[1]||(o[1]=c("h3",{class:"text-xl mb-3"},"Course Management",-1)),m.dashboard?v("",!0):(i(),p("div",S,[c("button",{onClick:o[0]||(o[0]=T=>s.value=!s.value),class:"bg-blue-500 py-2 text-white block col-start-2 ms-auto w-[200px] rounded"},"Add course")])),b(_,{onDelete:C,items:l.value},null,8,["items"])],2)])}}};export{N as default};
