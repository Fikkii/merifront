import{d as n,m as M,c,o as i,a as t,z as S,F as b,r as f,t as _,l as w,_ as $,x as B,h as L,j as V,i as j,k as x,n as h,p as F,v as N,b as z,w as A,y as E,M as H}from"./index-Doh7Rih5.js";import{m as I}from"./marked.esm-DKjyhwJX.js";const R={key:0},D={key:1,class:"bg-white p-4 rounded-xl shadow-sm"},G={class:"text-sm text-gray-700"},q=["onClick"],O={__name:"SuggestionCard",props:{inline:{type:Boolean,default:!1}},setup(k){const u=n([]),o=n(!1),s=n(""),d=async()=>{o.value=!0,s.value="";try{const a=await w.get("/api/ebooks/topics");if(!a.status==200)throw new Error("Failed to fetch topics");const l=await a.data;u.value=l.cards.splice(0,3)||[]}catch(a){s.value=a.message}finally{o.value=!1}};async function g(a){try{await navigator.clipboard.writeText(a)}catch(l){console.log(l)}}return M(()=>{d(),console.log(u)}),(a,l)=>o.value?(i(),c("div",R,l[0]||(l[0]=[t("img",{src:S,width:"20",alt:""},null,-1)]))):(i(),c("div",D,[l[1]||(l[1]=t("h3",{class:"text-lg font-semibold mb-2"},"Suggested Topics",-1)),(i(!0),c(b,null,f(u.value,v=>(i(),c("div",null,[t("div",G,[t("div",{onClick:y=>g(v),class:"p-2 mt-2 rounded shadow-lg"},_(v),9,q)])]))),256))]))}},P={class:"flex absolute flex-col h-[500px] bg-white dark:bg-gray-900 rounded-xl shadow p-4"},U={class:"relative"},J=["innerHTML"],K={class:"flex gap-2 justify-end"},Q=["disabled"],W={__name:"ChatCard",setup(k){async function u(){const r=await navigator.clipboard.readText();o.value=r,console.log(r)}const o=n(""),s=n([]),d=n(!1),g=n(!0),a=n(null),l="https://apigateway.merilearn.com.ng",v=localStorage.getItem("token")||"",y=async()=>{if(!o.value.trim())return;g.value=!1;const r={role:"user",content:o.value.trim()};s.value.push(r),o.value="",d.value=!0;try{const e=await w.post(`${l}/api/chat`,{message:r.content,history:s.value.slice(-10)},{headers:{Authorization:`Bearer ${v}`}});s.value.push({role:"model",content:e.data.reply});const m=H(()=>{s.map(value({role:value.role,content:I.parse(value.content)}))});console.log(m)}catch(e){s.value.push({role:"model",content:"⚠️ Failed to get response from Gemini."}),console.error(e)}finally{d.value=!1}};async function C(r){try{await navigator.clipboard.writeText(r.currentTarget.innerText)}catch(e){console.log(e)}}return B(s,()=>{nextTick(()=>{a.value.scrollTop=a.value.scrollHeight})}),(r,e)=>{const m=L("RouterLink");return i(),c("div",P,[e[3]||(e[3]=t("div",{class:"text-xl font-semibold mb-2 text-gray-800 dark:text-gray-100"},[x("Chat with AI "),t("div",{class:"text-sm"},"Powered by Gemini")],-1)),g.value?(i(),V(O,{key:0,onClick:u})):j("",!0),t("div",{ref_key:"chatContainer",ref:a,class:"flex-1 overflow-y-auto space-y-4 mb-4 px-2 scroll-smooth"},[(i(!0),c(b,null,f(s.value,(p,T)=>(i(),c("div",{key:T,class:h(["flex",p.role==="user"?"justify-end":"justify-start"])},[t("div",U,[t("button",{innerHTML:p.content,onClick:C,class:h(["max-w-sm px-3 py-2 rounded-lg prose-sm",p.role==="user"?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-800 dark:text-gray-100"])},null,10,J),e[1]||(e[1]=t("i",{class:"ri-clipboard-line text-lg"},null,-1))])],2))),128))],512),t("form",{onSubmit:E(y,["prevent"])},[F(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=p=>o.value=p),type:"text",placeholder:"Ask me anything...",class:"w-full px-4 py-2 rounded-lg border dark:border-gray-700 bg-white dark:bg-gray-800 dark:text-white focus:outline-none",required:""},null,512),[[N,o.value]]),t("div",K,[z(m,{to:{name:"ebooks"},type:"submit",class:"px-6 py-2 text-blue-500 rounded-lg hover:bg-blue-700 disabled:opacity-50"},{default:A(()=>e[2]||(e[2]=[x(" Explore Resources ")])),_:1,__:[2]}),t("button",{type:"submit",disabled:d.value,class:"px-6 py-2 bg-black text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},_(d.value?"Sending...":"Send"),9,Q)])],32)])}}},Z=$(W,[["__scopeId","data-v-7a71f904"]]);export{Z as C};
