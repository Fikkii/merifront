import{d as n,k as $,c as i,o as l,a as e,F as _,r as b,t as k,i as w,_ as S,q as M,j as B,s as C,g as L,h as x,n as f,l as V,v as j,b as F,w as N,x as A,y as E}from"./index-DB3DdxWr.js";import{_ as H}from"./loader-BZfJ8uUy.js";import{m as I}from"./marked.esm-DKjyhwJX.js";const R={key:0},q={key:1,class:"bg-white p-4 rounded-xl shadow-sm"},z={class:"text-sm text-gray-700"},D=["onClick"],G={__name:"SuggestionCard",props:{inline:{type:Boolean,default:!1}},setup(y){const c=n([]),t=n(!1),a=n(""),d=async()=>{t.value=!0,a.value="";try{const s=await w.get("/api/ebooks/topics");if(!s.status==200)throw new Error("Failed to fetch topics");const o=await s.data;c.value=o.cards.splice(0,3)||[]}catch(s){a.value=s.message}finally{t.value=!1}};async function g(s){try{await navigator.clipboard.writeText(s)}catch(o){console.log(o)}}return $(()=>{d(),console.log(c)}),(s,o)=>t.value?(l(),i("div",R,o[0]||(o[0]=[e("img",{src:H,width:"20",alt:""},null,-1)]))):(l(),i("div",q,[o[1]||(o[1]=e("h3",{class:"text-lg font-semibold mb-2"},"Suggested Topics",-1)),(l(!0),i(_,null,b(c.value,m=>(l(),i("div",null,[e("div",z,[e("div",{onClick:h=>g(m),class:"p-2 mt-2 rounded shadow-lg"},k(m),9,D)])]))),256))]))}},P={class:"flex flex-col h-[500px] bg-white dark:bg-gray-900 rounded-xl shadow p-4"},O=["innerHTML"],U={class:"flex gap-2 justify-end"},J=["disabled"],K={__name:"ChatCard",setup(y){async function c(){const u=await navigator.clipboard.readText();t.value=u,console.log(u)}const t=n(""),a=n([]),d=n(!1),g=n(!0),s=n(null),o="https://servmeri.fikki.com.ng",m=localStorage.getItem("token")||"",h=async()=>{if(!t.value.trim())return;g.value=!1;const u={role:"user",content:t.value.trim()};a.value.push(u),t.value="",d.value=!0;try{const r=await w.post(`${o}/api/chat`,{message:u.content,history:a.value.slice(-10)},{headers:{Authorization:`Bearer ${m}`}});a.value.push({role:"model",content:r.data.reply});const v=E(()=>{a.map(value({role:value.role,content:I.parse(value.content)}))});console.log(v)}catch(r){a.value.push({role:"model",content:"⚠️ Failed to get response from Gemini."}),console.error(r)}finally{d.value=!1}};return M(a,()=>{nextTick(()=>{s.value.scrollTop=s.value.scrollHeight})}),(u,r)=>{const v=B("RouterLink");return l(),i("div",P,[r[2]||(r[2]=e("div",{class:"text-xl font-semibold mb-2 text-gray-800 dark:text-gray-100"},[x("Chat with AI "),e("div",{class:"text-sm"},"Powered by Gemini")],-1)),g.value?(l(),C(G,{key:0,onClick:c})):L("",!0),e("div",{ref_key:"chatContainer",ref:s,class:"flex-1 overflow-y-auto space-y-4 mb-4 px-2 scroll-smooth"},[(l(!0),i(_,null,b(a.value,(p,T)=>(l(),i("div",{key:T,class:f(["flex",p.role==="user"?"justify-end":"justify-start"])},[e("div",{innerHTML:p.content,class:f(["max-w-sm px-4 py-2 rounded-lg prose-sm",p.role==="user"?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-800 dark:text-gray-100"])},null,10,O)],2))),128))],512),e("form",{onSubmit:A(h,["prevent"])},[V(e("textarea",{"onUpdate:modelValue":r[0]||(r[0]=p=>t.value=p),type:"text",placeholder:"Ask me anything...",class:"w-full px-4 py-2 rounded-lg border dark:border-gray-700 bg-white dark:bg-gray-800 dark:text-white focus:outline-none",required:""},null,512),[[j,t.value]]),e("div",U,[F(v,{to:{name:"ebooks"},type:"submit",class:"px-6 py-2 text-blue-500 rounded-lg hover:bg-blue-700 disabled:opacity-50"},{default:N(()=>r[1]||(r[1]=[x(" Explore Resources ")])),_:1,__:[1]}),e("button",{type:"submit",disabled:d.value,class:"px-6 py-2 bg-black text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},k(d.value?"Sending...":"Send"),9,J)])],32)])}}},Q=S(K,[["__scopeId","data-v-ad475a6e"]]),Z={__name:"ChatPage",setup(y){return(c,t)=>(l(),C(Q))}};export{Z as default};
