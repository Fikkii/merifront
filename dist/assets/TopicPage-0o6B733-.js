import{b as m,a as v,_ as S}from"./Modal-DVGjIwmO.js";import{_ as B}from"./ToastEditor-CrhTcC7F.js";import{d as a,f as N,m as V,h as $,c as D,o as y,a as n,j as z,i as M,w as b,b as w,k as R,n as F,l as r,M as O}from"./index-luTevwiG.js";import"./_commonjsHelpers-D6-XlEtG.js";const U={class:"relative"},A={class:"col-span-2"},P=["edit"],Q={__name:"TopicPage",setup(q){const i=a([]),p=a([]);a([]);const f=a(""),l=a(!1),_=N(),c=a(null),o=a(null),u=a(null),h=a([{name:"title",placeholder:"Enter topic Title",res:""},{name:"courseId",placeholder:"Enter Course ID",res:"",type:"select",options:[]},{name:"moduleId",placeholder:"Enter module ID",res:"",type:"select",options:[]},{name:"recommended_video",placeholder:"Enter Recommended Video link",res:""}]);V(async()=>{i.value=await m(),p.value=await v()});async function C(e){await r.delete(`/api/admin/topics/${e}`),i.value=await m(),p.value=await v(),console.log("Updating...")}async function T(e){c.value&&(f.value=c.value.saveContent()),e.append("content",f.value);const t=Object.fromEntries(e);try{if(o.value){const s=await r.put(`/api/admin/topics/${o.value}`,t,{headers:{"Content-Type":"application/json"}});_.success("Topic Edited Successfully...")}else{const s=await r.post("/api/admin/topics",t,{headers:{"Content-Type":"application/json"}});_.success("Topic Created Successfully...")}l.value=!l.value}catch(s){console.log(s)}finally{i.value=await m(),p.value=await v()}}function g(){l.value=!1}function x(e,t){o.value?u.value[e].res=t:h.value[e].res=t}async function k(e="1"){o.value=e;const t=await r.get(`/api/topics/${e}`),j=Object.entries(t.data).map(([d,I])=>["id","topic_content","module_title","course_title"].includes(d)?null:{name:d,placeholder:"No placeholder",type:"text",res:I}).filter(d=>d!=null);u.value=j,l.value=!0,await O(),c.value.setContent(t.data.topic_content)}function E(){l.value=!0,u.value=null,o.value=null}return(e,t)=>{const s=$("CategorizedTable");return y(),D("div",U,[n("div",null,[l.value?(y(),z(S,{key:0,fields:u.value||h.value,onUpdate:x,onClose:g,onSubmit:T},{default:b(()=>[n("div",A,[w(B,{ref_key:"toastRef",ref:c},null,512)])]),_:1},8,["fields"])):M("",!0)]),n("div",{class:F([l.value?"blur":""])},[w(s,{groupBy:"module_title",onEdit:k,onDelete:C,items:i.value},{default:b(()=>[n("button",{edit:o.value,onClick:E,class:"bg-blue-500 ms-auto py-2 text-white block col-start-2 w-[100px] rounded"},t[0]||(t[0]=[n("i",{class:"ri-add-line"},null,-1),R("Add Topic")]),8,P)]),_:1},8,["items"])],2)])}}};export{Q as default};
