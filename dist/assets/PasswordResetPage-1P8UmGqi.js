import{f as C,d,e as T,h as _,c as t,o,a as s,k as y,b as S,w as E,z as P,i as g,p as f,T as j,t as v,v as k,x as M}from"./index-luTevwiG.js";import{_ as N}from"./login-B4lAH5on.js";const V={class:"flex h-screen bg-white"},L={key:0,class:"w-full md:w-1/2 flex flex-col items-center justify-center p-8"},R={class:"prose mt-4"},O={key:1,class:"w-full md:w-1/2 flex items-center justify-center p-8"},$={class:"w-full max-w-md space-y-6"},q={key:0,class:"text-2xl text-indigo-500"},B={key:1,class:"text-2xl text-indigo-500"},D={key:2,class:"text-gray-500"},I={key:3,class:"text-gray-500"},U={key:0},J={class:"relative"},z=["type"],W={key:0},Y={key:1},A={class:"block mb-1 text-gray-700"},F={class:"relative"},G={key:0},H={key:1},K={type:"submit",class:"w-full flex gap-4 justify-center py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"},Q={key:0,width:"20",src:M,alt:"spinner"},ee={__name:"PasswordResetPage",props:{token:{type:String,default:null}},setup(a){const m=a,p=C(),c=d(""),i=d(""),r=d(!1),w=d(!1),u=d(!1);d(!0);const b=T();async function x(){if(u.value=!0,m.token)try{if(console.log(m.token),c.value!=i.value)throw new Error("password does not match...");const n=await fetch("https://apigateway.merilearn.com.ng/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:m.token,password:c.value})}),e=await n.json();if(n.ok)b.push({name:"login"}),p.success("Password has been Changed, Login to continue"),u.value=!1;else throw new Error("This Token is Invalid or has expired Token")}catch(n){u.value=!1,p.error(n.message)}else try{const n=await fetch("https://apigateway.merilearn.com.ng/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.value})}),e=await n.json();if(n.ok)p.success("Link sent, Check your email"),w.value=!0,u.value=!1;else throw new Error(e.error)}catch(n){u.value=!1,p.error(n.message)}}return(n,e)=>{const h=_("RouterLink");return o(),t("div",V,[w.value?(o(),t("div",L,[e[9]||(e[9]=s("div",{class:"text-3xl font-bold text-indigo-500"},[s("i",{class:"ri-mail-unread-line text-6xl"}),y("Check Your Mail")],-1)),e[10]||(e[10]=s("div",{class:"opacity-75 border-t-2 pt-3 mt-2"},"We've sent a link to your mail, please use it to reset your password",-1)),s("div",R,[e[7]||(e[7]=s("h3",null,"Tips for creating a strong password",-1)),e[8]||(e[8]=s("ul",null,[s("li",null,"Make sure your password is more than 8"),s("li",null,"Include Symbols and Numbers"),s("li",null,"use a password manager, use suggested password and let it handle your password for you"),s("li",null,"Make sure to secure your password manager")],-1)),S(h,{to:{name:"reset-password-email"}},{default:E(()=>e[6]||(e[6]=[y("Resend Email")])),_:1,__:[6]})])])):(o(),t("div",O,[s("div",$,[s("div",null,[a.token?(o(),t("div",B,"Change your password")):(o(),t("div",q,"Enter Email to continue")),a.token?(o(),t("span",I,"In setting a strong password, it is adviced you use sentences you can remember.This makes it hard to break for hackers")):(o(),t("span",D,"Please provide your email, a reset link will be sent to you, click on that link to continue..."))]),s("form",{onSubmit:e[5]||(e[5]=P(l=>x(),["prevent"])),class:"space-y-4 bg-blue-50 border-blue-500 p-6 rounded-lg shadow-2xl relative"},[a.token?(o(),t("div",U,[e[13]||(e[13]=s("label",{class:"block mb-1 text-gray-700"},"Enter new password",-1)),s("div",J,[f(s("input",{type:r.value?"text":"password","onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l),required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,z),[[j,c.value]]),s("button",{type:"button",onClick:e[1]||(e[1]=l=>r.value=!r.value),class:"absolute inset-y-0 right-3 flex items-center text-gray-600"},[r.value?(o(),t("span",W,e[11]||(e[11]=[s("i",{class:"ri-eye-close-line"},null,-1)]))):(o(),t("span",Y,e[12]||(e[12]=[s("i",{class:"ri-eye-line"},null,-1)])))])])])):g("",!0),s("div",null,[s("label",A,v(a.token?"Confirm your password":"Enter Email"),1),s("div",F,[a.token?f((o(),t("input",{key:0,type:"password","onUpdate:modelValue":e[2]||(e[2]=l=>i.value=l),required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[k,i.value]]):f((o(),t("input",{key:1,"onUpdate:modelValue":e[3]||(e[3]=l=>i.value=l),required:"",class:"w-full px-4 py-2 border rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[k,i.value]]),s("button",{type:"button",onClick:e[4]||(e[4]=l=>r.value=!r.value),class:"absolute inset-y-0 right-3 flex items-center text-gray-600"},[r.value?(o(),t("span",G)):(o(),t("span",H))])])]),s("button",K,[s("span",null,v(a.token?"Change Password":"Send Reset Link"),1),u.value?(o(),t("img",Q)):g("",!0)])],32),e[14]||(e[14]=s("p",{class:"text-center text-xs text-gray-400 mt-20"},[y("Powered by "),s("span",{class:"text-blue-500 font-bold"},"fikki.com.ng")],-1))])])),e[15]||(e[15]=s("div",{class:"hidden md:block md:w-1/2"},[s("img",{src:N,alt:"Man working on laptop",class:"w-full h-full object-cover"})],-1))])}}};export{ee as default};
